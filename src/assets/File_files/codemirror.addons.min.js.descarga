(function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror);})(function(k){function c(l,e){var f=l.getRange(b(e.line,e.ch-1),b(e.line,e.ch+1));return f.length==2?f:null;}function h(i){for(var l={name:"autoCloseBrackets",Backspace:function(n){var r,p,q,t;if(n.getOption("disableInput")){return k.Pass;}for(r=n.listSelections(),q=0;q<r.length;q++){if(!r[q].empty()||(p=c(n,r[q].head),!p||i.indexOf(p)%2!=0)){return k.Pass;}}for(q=r.length-1;q>=0;q--){t=r[q].head,n.replaceRange("",b(t.line,t.ch-1),b(t.line,t.ch+1));}}},m="",f=0;f<i.length;f+=2){(function(e,n){e!=n&&(m+=n),l["'"+e+"'"]=function(r){var p,w,o,q,x,y,t;if(r.getOption("disableInput")){return k.Pass;}for(p=r.listSelections(),o=0;o<p.length;o++){if(q=p[o],x=q.head,e=="'"&&r.getTokenTypeAt(x)=="comment"){return k.Pass;}if(t=r.getRange(x,b(x.line,x.ch+1)),q.empty()){if(e==n&&t==n){y=r.getRange(x,b(x.line,x.ch+3))==e+e+e?"skipThree":"skip";}else{if(e==n&&x.ch>1&&r.getRange(b(x.line,x.ch-2),x)==e+e&&(x.ch<=2||r.getRange(b(x.line,x.ch-3),b(x.line,x.ch-2))!=e)){y="addFour";}else{if(e==n&&k.isWordChar(t)){return k.Pass;}if(r.getLine(x.line).length==x.ch||m.indexOf(t)>=0||g.test(t)){y="both";}else{return k.Pass;}}}}else{y="surround";}if(w){if(w!=y){return k.Pass;}}else{w=y;}}r.operation(function(){var s,u;if(w=="skip"){r.execCommand("goCharRight");}else{if(w=="skipThree"){for(u=0;u<3;u++){r.execCommand("goCharRight");}}else{if(w=="surround"){for(s=r.getSelections(),u=0;u<s.length;u++){s[u]=e+s[u]+n;}r.replaceSelections(s,"around");}else{w=="both"?(r.replaceSelection(e+n,null),r.execCommand("goCharLeft")):w=="addFour"&&(r.replaceSelection(e+e+e+e,"before"),r.execCommand("goCharRight"));}}}});},e!=n&&(l["'"+n+"'"]=function(p){for(var r=p.listSelections(),o,q=0;q<r.length;q++){if(o=r[q],!o.empty()||p.getRange(o.head,b(o.head.line,o.head.ch+1))!=n){return k.Pass;}}p.execCommand("goCharRight");});})(i.charAt(f),i.charAt(f+1));}return l;}function j(e){return function(l){var i,m,n;if(l.getOption("disableInput")){return k.Pass;}for(i=l.listSelections(),m=0;m<i.length;m++){if(!i[m].empty()||(n=c(l,i[m].head),!n||e.indexOf(n)%2!=0)){return k.Pass;}}l.operation(function(){var o,f;for(l.replaceSelection("\n\n",null),l.execCommand("goCharLeft"),i=l.listSelections(),o=0;o<i.length;o++){f=i[o].head.line,l.indentLine(f,null,!0),l.indentLine(f+1,null,!0);}});};}var d="()[]{}''\"\"",a="[]{}",g=/\s/,b=k.Pos;k.defineOption("autoCloseBrackets",!1,function(l,e,o){var n,m,p;(o!=k.Init&&o&&l.removeKeyMap("autoCloseBrackets"),e)&&(n=d,m=a,typeof e=="string"?n=e:typeof e=="object"&&(e.pairs!=null&&(n=e.pairs),e.explode!=null&&(m=e.explode)),p=h(n),m&&(p.Enter=j(m)),l.addKeyMap(p));});}),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror"),require("../fold/xml-fold")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],a):a(CodeMirror);}(function(j){function g(u){var r,i,D,C,x,n,q;if(u.getOption("disableInput")){return j.Pass;}for(r=u.listSelections(),i=[],x=0;x<r.length;x++){if(!r[x].empty()){return j.Pass;}var H=r[x].head,m=u.getTokenAt(H),F=j.innerMode(u.getMode(),m.state),E=F.state;if(F.mode.name!="xml"||!E.tagName){return j.Pass;}var G=u.getOption("autoCloseTags"),z=F.mode.configuration=="html",t=typeof G=="object"&&G.dontCloseTags||z&&d,B=typeof G=="object"&&G.indentTags||z&&a,A=E.tagName;if(m.end>H.ch&&(A=A.slice(0,A.length-m.end+H.ch)),D=A.toLowerCase(),!A||m.type=="string"&&(m.end!=H.ch||!/[\"\']/.test(m.string.charAt(m.string.length-1))||m.string.length==1)||m.type=="tag"&&E.type=="closeTag"||m.string.indexOf("/")==m.string.length-1||t&&c(t,D)>-1||b(u,A,H,E,!0)){return j.Pass;}C=B&&c(B,D)>-1,i[x]={indent:C,text:">"+(C?"\n\n":"")+"</"+A+">",newPos:C?j.Pos(H.line+1,0):j.Pos(H.line,H.ch+1)};}for(x=r.length-1;x>=0;x--){n=i[x],u.replaceRange(n.text,r[x].head,r[x].anchor,"+insert"),q=u.listSelections().slice(0),q[x]={head:n.newPos,anchor:n.newPos},u.setSelections(q),n.indent&&(u.indentLine(n.newPos.line,null,!0),u.indentLine(n.newPos.line+1,null,!0));}}function h(k){var p,v,n;if(k.getOption("disableInput")){return j.Pass;}for(p=k.listSelections(),v=[],n=0;n<p.length;n++){if(!p[n].empty()){return j.Pass;}var m=p[n].head,q=k.getTokenAt(m),l=j.innerMode(k.getMode(),q.state),i=l.state;if(q.type=="string"||q.string.charAt(0)!="<"||q.start!=m.ch-1||l.mode.name!="xml"||!i.context||!i.context.tagName||b(k,i.context.tagName,m,i)){return j.Pass;}v[n]="/"+i.context.tagName+">";}k.replaceSelections(v);}function c(l,f){if(l.indexOf){return l.indexOf(f);}for(var e=0,k=l.length;e<k;++e){if(l[e]==f){return e;}}return -1;}function b(z,p,k,y,v){var q,m,w,x,n,A;if(!j.scanForClosingTag||(q=Math.min(z.lastLine()+1,k.line+500),m=j.scanForClosingTag(z,k,null,q),!m||m.tag!=p)){return !1;}for(w=y.context,x=v?1:0;w&&w.tagName==p;w=w.prev){++x;}for(k=m.to,n=1;n<x;n++){if(A=j.scanForClosingTag(z,k,null,q),!A||A.tag!=p){return !1;}k=A.to;}return !0;}j.defineOption("autoCloseTags",!1,function(k,f,l){if(l!=j.Init&&l&&k.removeKeyMap("autoCloseTags"),f){var e={name:"autoCloseTags"};(typeof f!="object"||f.whenClosing)&&(e["'/'"]=function(i){return h(i);}),(typeof f!="object"||f.whenOpening)&&(e["'>'"]=function(i){return g(i);}),k.addKeyMap(e);}});var d=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],a=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];}),function(){function b(h){var l=h.getCursor(),p=h.getTokenAt(l),j=CodeMirror.innerMode(h.getMode(),p.state).mode,d,g,m,k,q;if(p.type=="comment"&&j.blockCommentStart&&(g=p.string.indexOf(j.blockCommentEnd),m=h.getRange(CodeMirror.Pos(l.line,0),CodeMirror.Pos(l.line,p.end)),g==-1||g!=p.string.length-j.blockCommentEnd.length)){if(p.string.indexOf(j.blockCommentStart)==0){if(d=m.slice(0,p.start),!/^\s*$/.test(d)){for(d="",q=0;q<p.start;++q){d+=" ";}}}else{(k=m.indexOf(j.blockCommentContinue))!=-1&&k+j.blockCommentContinue.length>p.start&&/^\s*$/.test(m.slice(0,k))&&(d=m.slice(0,k));}}if(d!=null){h.replaceSelection("\n"+d+j.blockCommentContinue,"end");}else{return CodeMirror.Pass;}}for(var a=["clike","css","javascript"],c=0;c<a.length;++c){CodeMirror.extendMode(a[c],{blockCommentStart:"/*",blockCommentEnd:"*/",blockCommentContinue:" * "});}CodeMirror.defineOption("continueComments",null,function(g,e,f){f&&f!=CodeMirror.Init&&g.removeKeyMap("continueComment");var d={name:"continueComment"};d[typeof e=="string"?e:"Enter"]=b,g.addKeyMap(d);});}(),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror);}(function(c){function j(m,q,x,t){var p=m.getLineHandle(q.line),f=q.ch-1,v=f>=0&&a[p.text.charAt(f)]||a[p.text.charAt(++f)],r,w,y;return v?(r=v.charAt(1)==">"?1:-1,x&&r>0!=(f==q.ch))?null:(w=m.getTokenTypeAt(k(q.line,f+1)),y=g(m,k(q.line,f+(r>0?1:0)),r,w||null,t),y==null)?null:{from:k(q.line,f),to:y&&y.pos,match:y&&y.ch==v.charAt(0),forward:r>0}:null;}function g(r,x,I,A,B){for(var m=B&&B.maxScanLineLength||10000,F=B&&B.maxScanLines||1000,t=[],G=B&&B.bracketRegex?B.bracketRegex:/[(){}[\]]/,E=I>0?Math.min(x.line+F,r.lastLine()+1):Math.max(r.firstLine()-1,x.line-F),z,J,H,C,D,q=x.line;q!=E;q+=I){if((z=r.getLine(q),z)&&(J=I>0?0:z.length-1,H=I>0?z.length:-1,!(z.length>m))){for(q==x.line&&(J=x.ch-(I<0?1:0));J!=H;J+=I){if(C=z.charAt(J),G.test(C)&&(A===undefined||r.getTokenTypeAt(k(q,J+1))==A)){if(D=a[C],D.charAt(1)==">"==I>0){t.push(C);}else{if(t.length){t.pop();}else{return{pos:k(q,J),ch:C};}}}}}}return q-I==(I>0?r.lastLine():r.firstLine())?!1:null;}function h(q,t,m){for(var y=q.state.matchBrackets.maxHighlightLineLength||1000,w=[],u=q.listSelections(),v,x,s,p=0;p<u.length;p++){v=u[p].empty()&&j(q,u[p].head,!1,m),v&&q.getLine(v.from.line).length<=y&&(x=v.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",w.push(q.markText(v.from,k(v.from.line,v.from.ch+1),{className:x})),v.to&&q.getLine(v.to.line).length<=y&&w.push(q.markText(v.to,k(v.to.line,v.to.ch+1),{className:x})));}if(w.length){if(l&&q.state.focused&&q.display.input.focus(),s=function(){q.operation(function(){for(var e=0;e<w.length;e++){w[e].clear();}});},t){setTimeout(s,800);}else{return s;}}}function b(e){e.operation(function(){d&&(d(),d=null),d=h(e,!1,e.state.matchBrackets);});}var l=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8),k=c.Pos,a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},d=null;c.defineOption("matchBrackets",!1,function(f,e,m){if(m&&m!=c.Init&&f.off("cursorActivity",b),e){f.state.matchBrackets=typeof e=="object"?e:{};f.on("cursorActivity",b);}}),c.defineExtension("matchBrackets",function(){h(this,!0);}),c.defineExtension("findMatchingBracket",function(m,f,e){return j(this,m,f,e);}),c.defineExtension("scanForBracket",function(o,f,e,m){return g(this,o,f,e,m);});}),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror"),require("../fold/xml-fold")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../fold/xml-fold"],a):a(CodeMirror);}(function(d){function b(e){e.state.tagHit&&e.state.tagHit.clear(),e.state.tagOther&&e.state.tagOther.clear(),e.state.tagHit=e.state.tagOther=null;}function a(e){e.state.failedTagMatch=!1,e.operation(function(){var i,g,h,j,k;(b(e),e.somethingSelected())||(i=e.getCursor(),g=e.getViewport(),g.from=Math.min(g.from,i.line),g.to=Math.max(i.line+1,g.to),h=d.findMatchingTag(e,i,g),h)&&(e.state.matchBothTags&&(j=h.at=="open"?h.open:h.close,j&&(e.state.tagHit=e.markText(j.from,j.to,{className:"CodeMirror-matchingtag"}))),k=h.at=="close"?h.open:h.close,k?e.state.tagOther=e.markText(k.from,k.to,{className:"CodeMirror-matchingtag"}):e.state.failedTagMatch=!0);});}function c(e){e.state.failedTagMatch&&a(e);}d.defineOption("matchTags",!1,function(g,h,i){if(i&&i!=d.Init&&(g.off("cursorActivity",a),g.off("viewportChange",c),b(g)),h){g.state.matchBothTags=typeof h=="object"&&h.bothTags;g.on("cursorActivity",a);g.on("viewportChange",c);a(g);}}),d.commands.toMatchingTag=function(f){var e=d.findMatchingTag(f,f.getCursor()),g;e&&(g=e.at=="close"?e.open:e.close,g&&f.extendSelection(g.to,g.from));};}),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror);}(function(a){a.defineOption("showTrailingSpace",!1,function(c,b,d){d==a.Init&&(d=!1),d&&!b?c.removeOverlay("trailingspace"):!d&&b&&c.addOverlay({token:function(g){for(var f=g.string.length,e=f;e&&/\s/.test(g.string.charAt(e-1));--e){}return e>g.pos?(g.pos=e,null):(g.pos=f,"trailingspace");},name:"trailingspace"});});}),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror);}(function(e){function c(k,t,n,p){function r(o){var h=v(k,t),l,i;if(!h||h.to.line-h.from.line<j){return null;}for(l=k.findMarksAt(h.from),i=0;i<l.length;++i){if(l[i].__isFold&&p!=="fold"){if(!o){return null;}h.cleared=!0,l[i].clear();}}return h;}var v,j,g,m,q;if(n&&n.call?(v=n,n=null):v=b(k,n,"rangeFinder"),typeof t=="number"&&(t=e.Pos(t,0)),j=b(k,n,"minFoldSize"),g=r(!0),b(k,n,"scanUp")){while(!g&&t.line>k.firstLine()){t=e.Pos(t.line-1,0),g=r(!1);}}if(g&&!g.cleared&&p!=="unfold"){m=d(k,n);e.on(m,"mousedown",function(f){q.clear(),e.e_preventDefault(f);});q=k.markText(g.from,g.to,{replacedWith:m,clearOnEnter:!0,__isFold:!0});q.on("clear",function(f,h){e.signal(k,"unfold",k,f,h);});e.signal(k,"fold",k,g.from,g.to);}}function d(j,g){var h=b(j,g,"widget"),f;return typeof h=="string"&&(f=document.createTextNode(h),h=document.createElement("span"),h.appendChild(f),h.className="CodeMirror-foldmarker"),h;}function b(j,g,f){if(g&&g[f]!==undefined){return g[f];}var h=j.options.foldOptions;return h&&h[f]!==undefined?h[f]:a[f];}e.newFoldFunction=function(g,f){return function(i,h){c(i,h,{rangeFinder:g,widget:f});};},e.defineExtension("foldCode",function(h,f,g){c(this,h,f,g);}),e.defineExtension("isFolded",function(h){for(var g=this.findMarksAt(h),f=0;f<g.length;++f){if(g[f].__isFold){return !0;}}}),e.commands.toggleFold=function(f){f.foldCode(f.getCursor());},e.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold");},e.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold");},e.commands.foldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(e.Pos(g,0),null,"fold");}});},e.commands.unfoldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(e.Pos(g,0),null,"unfold");}});},e.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(j,h){for(var g,k=0;k<f.length;++k){if(g=f[k](j,h),g){return g;}}};}),e.registerHelper("fold","auto",function(k,h){for(var f=k.getHelpers(h,"fold"),j,g=0;g<f.length;g++){if(j=f[g](k,h),j){return j;}}});var a={rangeFinder:e.fold.auto,widget:"â†”",minFoldSize:0,scanUp:!1};e.defineOption("foldOptions",null);}),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror);}(function(a){a.registerHelper("fold","brace",function(n,D){function z(c){for(var b,e=D.ch,h=0;;){if(b=e<=0?-1:d.lastIndexOf(c,e-1),b==-1){if(h==1){break;}h=1,e=d.length;continue;}if(h==1&&b<D.ch){break;}if(B=n.getTokenTypeAt(a.Pos(G,b+1)),!/^(comment|string)/.test(B)){return b+1;}e=b-1;}}var G=D.line,d=n.getLine(G),B,g="{",I="}",m=z("{"),J,C,E,j,F,A,x,q,H;if(m==null&&(g="[",I="]",m=z("[")),m!=null){J=1,C=n.lastLine();a:for(F=G;F<=C;++F){for(A=n.getLine(F),x=F==G?m:0;;){if(q=A.indexOf(g,x),H=A.indexOf(I,x),q<0&&(q=A.length),H<0&&(H=A.length),x=Math.min(q,H),x==A.length){break;}if(n.getTokenTypeAt(a.Pos(F,x+1))==B){if(x==q){++J;}else{if(!--J){E=F,j=x;break a;}}}++x;}}if(E!=null&&(G!=E||j!=m)){return{from:a.Pos(G,m),to:a.Pos(E,j)};}}}),a.registerHelper("fold","import",function(d,c){function g(m){var n,l,q,s,p;if(m<d.firstLine()||m>d.lastLine()||(n=d.getTokenAt(a.Pos(m,1)),/\S/.test(n.string)||(n=d.getTokenAt(a.Pos(m,n.end+1))),n.type!="keyword"||n.string!="import")){return null;}for(l=m,q=Math.min(d.lastLine(),m+10);l<=q;++l){if(s=d.getLine(l),p=s.indexOf(";"),p!=-1){return{startCh:n.end,end:a.Pos(l,p)};}}}var c=c.line,h=g(c),k,b,j;if(!h||g(c-1)||(k=g(c-2))&&k.end.line==c-1){return null;}for(b=h.end;;){if(j=g(b.line+1),j==null){break;}b=j.end;}return{from:d.clipPos(a.Pos(c,h.startCh+1)),to:b};}),a.registerHelper("fold","include",function(d,c){function b(e){if(e<d.firstLine()||e>d.lastLine()){return null;}var f=d.getTokenAt(a.Pos(e,1));return/\S/.test(f.string)||(f=d.getTokenAt(a.Pos(e,f.end+1))),f.type=="meta"&&f.string.slice(0,8)=="#include"?f.start+8:void 0;}var c=c.line,h=b(c),g,j;if(h==null||b(c-1)!=null){return null;}for(g=c;;){if(j=b(g+1),j==null){break;}++g;}return{from:a.Pos(c,h+1),to:d.clipPos(a.Pos(g))};});}),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror);}(function(j){function C(c,a){return c.line-a.line||c.ch-a.ch;}function m(f,c,a,e){this.line=c,this.ch=a,this.cm=f,this.text=f.getLine(c),this.min=e?e.from:f.firstLine(),this.max=e?e.to-1:f.lastLine();}function D(e,a){var c=e.cm.getTokenTypeAt(E(e.line,a));return c&&/\btag\b/.test(c);}function q(a){if(!(a.line>=a.max)){return a.ch=0,a.text=a.cm.getLine(++a.line),!0;}}function z(a){if(!(a.line<=a.min)){return a.text=a.cm.getLine(--a.line),a.ch=a.text.length,!0;}}function x(f){for(var c,a,e;;){if(c=f.text.indexOf(">",f.ch),c==-1){if(q(f)){continue;}else{return;}}if(!D(f,c+1)){f.ch=c+1;continue;}return a=f.text.lastIndexOf("/",c),e=a>-1&&!/\S/.test(f.text.slice(a+1,c)),f.ch=c+1,e?"selfClose":"regular";}}function g(e){for(var c,a;;){if(c=e.ch?e.text.lastIndexOf("<",e.ch-1):-1,c==-1){if(z(e)){continue;}else{return;}}if(!D(e,c+1)){e.ch=c;continue;}if(b.lastIndex=c,e.ch=c,a=b.exec(e.text),a&&a.index==c){return a;}}}function k(c){for(;;){b.lastIndex=c.ch;var a=b.exec(c.text);if(!a){if(q(c)){continue;}else{return;}}if(!D(c,a.index+1)){c.ch=a.index+1;continue;}return c.ch=a.index+a[0].length,a;}}function d(f){for(var c,a,e;;){if(c=f.ch?f.text.lastIndexOf(">",f.ch-1):-1,c==-1){if(z(f)){continue;}else{return;}}if(!D(f,c+1)){f.ch=c;continue;}return a=f.text.lastIndexOf("/",c),e=a>-1&&!/\S/.test(f.text.slice(a+1,c)),f.ch=c+1,e?"selfClose":"regular";}}function w(y,c){for(var t=[],a;;){var p=k(y),v,l=y.line,e=y.ch-(p?p[0].length:0);if(!p||!(v=x(y))){return;}if(v!="selfClose"){if(p[1]){for(a=t.length-1;a>=0;--a){if(t[a]==p[2]){t.length=a;break;}}if(a<0&&(!c||c==p[2])){return{tag:p[2],from:E(l,e),to:E(y.line,y.ch)};}}else{t.push(p[2]);}}}}function B(y,c){for(var t=[],v,a;;){if(v=d(y),!v){return;}if(v=="selfClose"){g(y);continue;}var o=y.line,l=y.ch,p=g(y);if(!p){return;}if(p[1]){t.push(p[2]);}else{for(a=t.length-1;a>=0;--a){if(t[a]==p[2]){t.length=a;break;}}if(a<0&&(!c||c==p[2])){return{tag:p[2],from:E(y.line,y.ch),to:E(o,l)};}}}}var E=j.Pos,F="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",A=F+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",b=new RegExp("<(/?)(["+F+"]["+A+"]*)","g");j.registerHelper("fold","xml",function(l,f){for(var a=new m(l,f.line,0),i,e,f,c;;){if(i=k(a),!i||a.line!=f.line||!(e=x(a))){return;}if(!i[1]&&e!="selfClose"){return f=E(a.line,a.ch),c=w(a,i[2]),c&&{from:f,to:c.from};}}}),j.findMatchingTag=function(v,o,e){var i=new m(v,o.line,o.ch,e),t;if(i.text.indexOf(">")!=-1||i.text.indexOf("<")!=-1){var p=x(i),a=p&&E(i.line,i.ch),f=p&&g(i);if(p&&p!="selfClose"&&f&&!(C(i,o)>0)){return t={from:E(i.line,i.ch),to:a,tag:f[2]},f[1]?{open:B(i,f[2]),close:t,at:"close"}:(i=new m(v,a.line,a.ch,e),{open:t,close:w(i,f[2]),at:"open"});}}},j.findEnclosingTag=function(p,c,h){for(var f=new m(p,c.line,c.ch,h),a,l,i;;){if(a=B(f),!a){break;}if(l=new m(p,c.line,c.ch,h),i=w(l,a.tag),i){return{open:a,close:i};}}},j.scanForClosingTag=function(i,c,f,a){var h=new m(i,c.line,c.ch,a?{from:0,to:a}:null);return w(h,f);};}),function(){CodeMirror.defineExtension("autoFormatAll",function(j,E){function C(){q+="\n",x=!0,++B;}for(var b=this,w=b.getMode(),g=b.getRange(j,E).split("\n"),F=CodeMirror.copyState(w,b.getTokenAt(j).state),A=b.getOption("tabSize"),q="",B=0,x=j.ch==0,m,D=0;D<g.length;++D){for(m=new CodeMirror.StringStream(g[D],A);!m.eol();){var z=CodeMirror.innerMode(w,F),d=w.token(m,F),k=m.current();m.start=m.pos,(!x||/\S/.test(k))&&(q+=k,x=!1),!x&&z.mode.newlineAfterToken&&z.mode.newlineAfterToken(d,k,m.string.slice(m.pos)||g[D+1]||"",z.state)&&C();}!m.pos&&w.blankLine&&w.blankLine(F),!x&&D<g.length-1&&C();}b.operation(function(){b.replaceRange(q,j,E);for(var c=j.line+1,a=j.line+B;c<=a;++c){b.indentLine(c,"smart");}b.setCursor({line:0,ch:0});});});}(),function(){function a(h){for(var g=[/for\s*?\((.*?)\)/g,/&#?[a-z0-9]+;[\s\S]/g,/\"(.*?)((\")|$)/g,/\/\*(.*?)(\*\/|$)/g,/^\/\/.*/g],b=[],d,c,e=0;e<g.length;e++){for(d=0;d<h.length;){if(c=h.substr(d).match(g[e]),c!=null){b.push({start:d+c.index,end:d+c.index+c[0].length}),d+=c.index+Math.max(1,c[0].length);}else{break;}}}return b.sort(function(i,f){return i.start-f.start;}),b;}CodeMirror.extendMode("css",{commentStart:"/*",commentEnd:"*/",newlineAfterToken:function(c,b){return/^[;{}]$/.test(b);}}),CodeMirror.extendMode("javascript",{commentStart:"/*",commentEnd:"*/",wordWrapChars:[";","\\{","\\}"],autoFormatLineBreaks:function(d){var g=0,j=this.jsonMode?function(e){return e.replace(/([,{])/g,"$1\n").replace(/}/g,"\n}");}:function(e){return e.replace(/(;|\{|\})([^\r\n;])/g,"$1\n$2");},b=a(d),h="",c;if(b!=null){for(c=0;c<b.length;c++){b[c].start>g&&(h+=j(d.substring(g,b[c].start)),g=b[c].start),b[c].start<=g&&b[c].end>=g&&(h+=d.substring(g,b[c].end),g=b[c].end);}g<d.length&&(h+=j(d.substr(g)));}else{h=j(d);}return h.replace(/^\n*|\n*$/,"");}});CodeMirror.extendMode("xml",{commentStart:"<!--",commentEnd:"-->",noBreak:!1,noBreakEmpty:null,tagType:"",tagName:"",isXML:!1,newlineAfterToken:function(d,l,g){var c="a|b|bdi|bdo|big|center|cite|del|em|font|i|img|ins|s|small|span|strike|strong|sub|sup|u",j="label|li|option|textarea|title|"+c,h=!1,b=null,k="",m;if(this.isXML=this.configuration=="xml"?!0:!1,d=="comment"||/<!--/.test(g)){return !1;}if(d=="tag"){if(l.indexOf("<")==0&&!l.indexOf("</")==0&&(this.tagType="open",b=l.match(/^<\s*?([\w]+?)$/i),this.tagName=b!=null?b[1]:"",k=this.tagName.toLowerCase(),("|"+j+"|").indexOf("|"+k+"|")!=-1&&(this.noBreak=!0)),l.indexOf(">")==0&&this.tagType=="open"){return(this.tagType="",m=this.isXML?"[^<]*?":"",RegExp("^"+m+"</s*?"+this.tagName+"s*?>","i").test(g))?(this.noBreak=!1,this.isXML||(this.tagName=""),!1):(h=this.noBreak,this.noBreak=!1,h?!1:!0);}if(l.indexOf("</")==0&&(this.tagType="close",b=l.match(/^<\/\s*?([\w]+?)$/i),b!=null&&(k=b[1].toLowerCase()),("|"+c+"|").indexOf("|"+k+"|")!=-1&&(this.noBreak=!0)),l.indexOf(">")==0&&this.tagType=="close"){return(this.tagType="",g.indexOf("<")==0&&(b=g.match(/^<\/?\s*?([\w]+?)(\s|>)/i),k=b!=null?b[1].toLowerCase():"",("|"+j+"|").indexOf("|"+k+"|")==-1))?(this.noBreak=!1,!0):(h=this.noBreak,this.noBreak=!1,h?!1:!0);}}return g.indexOf("<")==0?(this.noBreak=!1,this.isXML&&this.tagName!="")?(this.tagName="",!1):(b=g.match(/^<\/?\s*?([\w]+?)(\s|>)/i),k=b!=null?b[1].toLowerCase():"",("|"+j+"|").indexOf("|"+k+"|")!=-1?!1:!0):!1;}}),CodeMirror.defineExtension("commentRange",function(f,d,c){var e=this,b=CodeMirror.innerMode(e.getMode(),e.getTokenAt(d).state).mode;e.operation(function(){if(f){e.replaceRange(b.commentEnd,c),e.replaceRange(b.commentStart,d),d.line==c.line&&d.ch==c.ch&&e.setCursor(d.line,d.ch+b.commentStart.length);}else{var g=e.getRange(d,c),h=g.indexOf(b.commentStart),i=g.lastIndexOf(b.commentEnd);h>-1&&i>-1&&i>h&&(g=g.substr(0,h)+g.substring(h+b.commentStart.length,i)+g.substr(i+b.commentEnd.length)),e.replaceRange(g,d,c);}});}),CodeMirror.defineExtension("autoIndentRange",function(d,c){var b=this;this.operation(function(){for(var e=d.line;e<=c.line;e++){b.indentLine(e,"smart");}});}),CodeMirror.defineExtension("autoFormatRange",function(j,E){function C(){q+="\n",x=!0,++B;}for(var m=this,w=m.getMode(),g=m.getRange(j,E).split("\n"),F=CodeMirror.copyState(w,m.getTokenAt(j).state),A=m.getOption("tabSize"),q="",B=0,x=j.ch==0,b,D=0;D<g.length;++D){for(b=new CodeMirror.StringStream(g[D],A);!b.eol();){var z=CodeMirror.innerMode(w,F),d=w.token(b,F),k=b.current();b.start=b.pos,(!x||/\S/.test(k))&&(q+=k,x=!1),!x&&z.mode.newlineAfterToken&&z.mode.newlineAfterToken(d,k,b.string.slice(b.pos)||g[D+1]||"",z.state)&&C();}!b.pos&&w.blankLine&&w.blankLine(F),!x&&D<g.length-1&&C();}m.operation(function(){m.replaceRange(q,j,E);for(var e=j.line+1,c=j.line+B;e<=c;++e){m.indentLine(e,"smart");}m.setSelection(j,m.getCursor(!1));});});}(),function(a){typeof exports=="object"&&typeof module=="object"?a(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror);}(function(c){function b(e){typeof e=="object"&&(this.minChars=e.minChars,this.style=e.style,this.showToken=e.showToken,this.delay=e.delay),this.style==null&&(this.style=g),this.minChars==null&&(this.minChars=j),this.delay==null&&(this.delay=h),this.overlay=this.timeout=null;}function k(f){var e=f.state.matchHighlighter;clearTimeout(e.timeout),e.timeout=setTimeout(function(){d(f);},e.delay);}function d(e){e.operation(function(){var x=e.state.matchHighlighter,m,y,p;if(x.overlay&&(e.removeOverlay(x.overlay),x.overlay=null),!e.somethingSelected()&&x.showToken){for(var r=x.showToken===!0?/[\w$]/:x.showToken,v=e.getCursor(),q=e.getLine(v.line),n=v.ch,w=n;n&&r.test(q.charAt(n-1));){--n;}while(w<q.length&&r.test(q.charAt(w))){++w;}n<w&&e.addOverlay(x.overlay=a(q.slice(n,w),r,x.style));return;}(m=e.getCursor("from"),y=e.getCursor("to"),m.line==y.line)&&(p=e.getRange(m,y).replace(/^\s+|\s+$/g,""),p.length>=x.minChars&&e.addOverlay(x.overlay=a(p,!1,x.style)));});}function l(f,e){return(!f.start||!e.test(f.string.charAt(f.start-1)))&&(f.pos==f.string.length||!e.test(f.string.charAt(f.pos)));}function a(m,f,e){return{token:function(i){if(i.match(m)&&(!f||l(i,f))){return e;}i.next(),i.skipTo(m.charAt(0))||i.skipToEnd();}};}var j=2,g="matchhighlight",h=100;c.defineOption("highlightSelectionMatches",!1,function(m,i,n){if(n&&n!=c.Init){var o=m.state.matchHighlighter.overlay;o&&m.removeOverlay(o),clearTimeout(m.state.matchHighlighter.timeout),m.state.matchHighlighter=null,m.off("cursorActivity",k);}if(i){m.state.matchHighlighter=new b(i),d(m);m.on("cursorActivity",k);}});});